<?xml version="1.0" encoding="UTF-8"?>

<!--
Modern Payment Interface FXML
File: src/main/resources/fxml/payment/payment.fxml
-->

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.image.ImageView?>

<BorderPane xmlns="http://javafx.com/javafx/17.0.2-ea" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.cafe.controller.payment.PaymentController"
            stylesheets="@../../css/payment.css"
            prefWidth="1200" prefHeight="750" minWidth="1000" minHeight="650">

    <!-- Header -->
    <top>
        <HBox styleClass="header-container" alignment="CENTER_LEFT" spacing="20">
            <padding>
                <Insets top="20" right="30" bottom="20" left="30"/>
            </padding>
            
            <VBox spacing="5">
                <Label text="ðŸ’³ Thanh ToÃ¡n" styleClass="header-title"/>
            </VBox>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <!-- Order Info Section -->
            <HBox spacing="20" styleClass="order-info-section">
                <VBox spacing="5">
                    <Label text="MÃ£ Ä‘Æ¡n hÃ ng:" styleClass="info-label"/>
                    <Label fx:id="orderIdLabel" text="ORD-001" styleClass="info-value"/>
                </VBox>
                <VBox spacing="5">
                    <Label text="BÃ n:" styleClass="info-label"/>
                    <Label fx:id="tableIdLabel" text="BÃ n 1" styleClass="info-value"/>
                </VBox>
                <VBox spacing="5">
                    <Label text="Thá»i gian:" styleClass="info-label"/>
                    <Label fx:id="orderTimeLabel" text="14:30 19/12/2024" styleClass="info-value"/>
                </VBox>
                <VBox spacing="5">
                    <Label text="NhÃ¢n viÃªn:" styleClass="info-label"/>
                    <Label fx:id="serverNameLabel" text="Admin" styleClass="staff-name"/>
                </VBox>
            </HBox>
        </HBox>
    </top>

    <center>
        <HBox styleClass="main-container" spacing="20">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>

            <!-- Left Panel - Shopping Cart -->
            <VBox styleClass="cart-panel" spacing="15" prefWidth="450" minWidth="400" maxWidth="500">
                <VBox spacing="10" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label text="ðŸ›’ Giá» HÃ ng" styleClass="panel-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="totalItemsLabel" text="0 mÃ³n" styleClass="item-count"/>
                    </HBox>
                    
                    <!-- Items Table -->
                    <TableView fx:id="itemsTableView" styleClass="cart-table" prefHeight="200" maxHeight="300">
                        <columns>
                            <TableColumn fx:id="sttColumn" text="STT" prefWidth="40" sortable="false"/>
                            <TableColumn fx:id="itemNameColumn" text="MÃ³n" prefWidth="180" sortable="false"/>
                            <TableColumn fx:id="quantityColumn" text="SL" prefWidth="50" sortable="false"/>
                            <TableColumn fx:id="unitPriceColumn" text="ÄÆ¡n giÃ¡" prefWidth="80" sortable="false"/>
                            <TableColumn fx:id="totalPriceColumn" text="ThÃ nh tiá»n" prefWidth="100" sortable="false"/>
                        </columns>
                        <placeholder>
                            <Label text="ChÆ°a cÃ³ mÃ³n nÃ o trong giá» hÃ ng" styleClass="empty-cart-message"/>
                        </placeholder>
                    </TableView>
                </VBox>
                
                <!-- Customer Information Section -->
                <VBox spacing="10" styleClass="customer-section">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label text="ðŸ‘¤ ThÃ´ng tin khÃ¡ch hÃ ng (tÃ¹y chá»n)" styleClass="section-subtitle"/>
                        <Region HBox.hgrow="ALWAYS"/>
                    </HBox>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <VBox spacing="5">
                            <Label text="Sá»‘ Ä‘iá»‡n thoáº¡i:" styleClass="customer-label"/>
                            <ComboBox fx:id="customerPhoneField" promptText="Nháº­p SÄT (tÃ¹y chá»n)..." 
                                     styleClass="customer-input" prefWidth="140" editable="true"/>
                        </VBox>
                        <VBox spacing="5">
                            <Label text="TÃªn khÃ¡ch hÃ ng:" styleClass="customer-label"/>
                            <TextField fx:id="customerNameField" promptText="TÃªn khÃ¡ch hÃ ng (tÃ¹y chá»n)..." 
                                     styleClass="customer-input" prefWidth="180"/>
                        </VBox>
                    </HBox>
                    
                    <Label text="ðŸ’¡ LÆ°u Ã½: CÃ³ thá»ƒ thanh toÃ¡n mÃ  khÃ´ng cáº§n nháº­p thÃ´ng tin khÃ¡ch hÃ ng" 
                           styleClass="info-note"/>
                </VBox>
            </VBox>

            <!-- Right Panel - Payment -->
            <VBox styleClass="payment-panel" spacing="15" prefWidth="350" minWidth="320" maxWidth="380">
                
                <!-- Payment Summary -->
                <VBox spacing="15" styleClass="summary-section">
                    <Label text="ðŸ’° TÃ³m Táº¯t Thanh ToÃ¡n" styleClass="panel-title"/>
                    
                    <VBox spacing="12" styleClass="summary-details">
                        <HBox styleClass="summary-row">
                            <Label text="Táº¡m tÃ­nh" styleClass="summary-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="subtotalLabel" text="0â‚«" styleClass="summary-value"/>
                        </HBox>
                        
                        <HBox styleClass="summary-row">
                            <Label text="Thuáº¿ VAT (8%)" styleClass="summary-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="vatAmountLabel" text="0â‚«" styleClass="summary-value"/>
                        </HBox>
                        
                        <HBox fx:id="discountRow" styleClass="summary-row discount-row" visible="false" managed="false">
                            <Label text="Giáº£m giÃ¡" styleClass="summary-label discount-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="discountAmountLabel" text="-0â‚«" styleClass="summary-value discount-value"/>
                        </HBox>
                        
                        <Separator styleClass="summary-separator"/>
                        
                        <HBox styleClass="summary-row total-row">
                            <Label text="Tá»”NG Cá»˜NG" styleClass="total-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="grandTotalLabel" text="0â‚«" styleClass="total-value"/>
                        </HBox>
                    </VBox>
                </VBox>

                <!-- Promotion Section -->
                <VBox spacing="15" styleClass="promotion-section">
                    <Label text="ðŸŽŸï¸ Khuyáº¿n MÃ£i" styleClass="section-subtitle"/>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <ComboBox fx:id="promotionComboBox" prefWidth="200" promptText="Chá»n khuyáº¿n mÃ£i..."/>
                        <Button fx:id="applyPromotionButton" text="Ãp dá»¥ng" styleClass="promotion-button"/>
                    </HBox>
                    
                    <Label fx:id="appliedPromotionLabel" text="" styleClass="applied-promotion" 
                           visible="false" managed="false"/>
                </VBox>

                <!-- Payment Methods -->
                <VBox spacing="15" styleClass="payment-methods-section">
                    <Label text="ðŸ’³ PhÆ°Æ¡ng Thá»©c Thanh ToÃ¡n" styleClass="section-subtitle"/>
                    
                    <VBox spacing="10">
                        <fx:define>
                            <ToggleGroup fx:id="paymentMethodGroup"/>
                        </fx:define>
                        
                        <HBox spacing="15">
                            <VBox spacing="8">
                                <RadioButton fx:id="cashRadio" text="ðŸ’µ Tiá»n máº·t" 
                                           styleClass="payment-method-radio" toggleGroup="$paymentMethodGroup" selected="true"/>
                                <RadioButton fx:id="cardRadio" text="ðŸ’³ Tháº» tÃ­n dá»¥ng" 
                                           styleClass="payment-method-radio" toggleGroup="$paymentMethodGroup"/>
                                <RadioButton fx:id="momoRadio" text="ðŸ“± MoMo" 
                                           styleClass="payment-method-radio" toggleGroup="$paymentMethodGroup"/>
                            </VBox>
                            <VBox spacing="8">
                                <RadioButton fx:id="vnpayRadio" text="ðŸ›’ VNPay" 
                                           styleClass="payment-method-radio" toggleGroup="$paymentMethodGroup"/>
                                <RadioButton fx:id="zalopayRadio" text="ðŸ’™ ZaloPay" 
                                           styleClass="payment-method-radio" toggleGroup="$paymentMethodGroup"/>
                                <RadioButton fx:id="transferRadio" text="ðŸ¦ Chuyá»ƒn khoáº£n" 
                                           styleClass="payment-method-radio" toggleGroup="$paymentMethodGroup"/>
                            </VBox>
                        </HBox>
                    </VBox>
                </VBox>

                <!-- Cash Payment Details -->
                <VBox fx:id="cashPaymentSection" spacing="15" styleClass="cash-details-section">
                    <Label text="ðŸ’µ Chi Tiáº¿t Thanh ToÃ¡n Tiá»n Máº·t" styleClass="section-subtitle"/>
                    
                    <VBox spacing="10" styleClass="cash-calculation">
                        <HBox styleClass="cash-row">
                            <Label text="Tá»•ng tiá»n" styleClass="cash-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="cashTotalLabel" text="0â‚«" styleClass="cash-value"/>
                        </HBox>
                        
                        <HBox styleClass="cash-row">
                            <Label text="KhÃ¡ch Ä‘Æ°a" styleClass="cash-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <TextField fx:id="customerAmountField" text="" styleClass="cash-input" 
                                     promptText="Nháº­p sá»‘ tiá»n..." prefWidth="120" disable="true"/>
                        </HBox>
                        
                        <HBox styleClass="cash-row">
                            <Label text="Tiá»n thá»«a" styleClass="cash-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="changeAmountLabel" text="0â‚«" styleClass="change-value"/>
                        </HBox>
                    </VBox>
                    
                    <Label fx:id="cashErrorLabel" text="" styleClass="error-message" 
                           visible="false" managed="false"/>
                </VBox>

                <!-- QR Code Section (for digital wallets) -->
                <VBox fx:id="qrCodeSection" spacing="15" styleClass="qr-section" 
                      visible="false" managed="false">
                    <Label text="ðŸ“± Thanh ToÃ¡n QR Code" styleClass="section-subtitle"/>
                    
                    <VBox spacing="10" alignment="CENTER">
                        <VBox fx:id="qrCodeContainer" spacing="10" alignment="CENTER">
                            <ImageView fx:id="qrCodeImageView" fitWidth="150" fitHeight="150" 
                                     preserveRatio="true" styleClass="qr-code"/>
                            <Label fx:id="qrCodeInstructionLabel" text="QuÃ©t mÃ£ QR Ä‘á»ƒ thanh toÃ¡n" styleClass="qr-instruction"/>
                        </VBox>
                        
                        <VBox spacing="8" alignment="CENTER">
                            <Label text="MÃ£ giao dá»‹ch (sau khi thanh toÃ¡n):" styleClass="transaction-label"/>
                            <TextField fx:id="qrTransactionCodeField" promptText="Nháº­p mÃ£ giao dá»‹ch..." 
                                     styleClass="transaction-input" prefWidth="200"/>
                        </VBox>
                    </VBox>
                </VBox>

                <!-- Card Payment Section -->
                <VBox fx:id="cardPaymentSection" spacing="15" styleClass="card-section" 
                      visible="false" managed="false">
                    <Label text="ðŸ’³ Thanh ToÃ¡n Tháº»" styleClass="section-subtitle"/>
                    
                    <VBox spacing="10" styleClass="card-instructions">
                        <Label text="1. QuÃ©t tháº» trÃªn mÃ¡y POS" styleClass="instruction"/>
                        <Label text="2. Nháº­p mÃ£ PIN náº¿u Ä‘Æ°á»£c yÃªu cáº§u" styleClass="instruction"/>
                        <Label text="3. Báº¥m 'Thanh toÃ¡n' Ä‘á»ƒ hoÃ n táº¥t" styleClass="instruction"/>
                        
                        <Label text="ðŸ’¡ DÃ nh cho project há»c táº­p - khÃ´ng cáº§n mÃ£ giao dá»‹ch" 
                               styleClass="instruction" style="-fx-text-fill: #666; -fx-font-style: italic;"/>
                    </VBox>
                </VBox>

                <!-- Legacy Card Transfer Section (for compatibility) -->
                <VBox fx:id="cardTransferSection" spacing="15" styleClass="section" 
                      visible="false" managed="false">
                    <Label text="ThÃ´ng tin giao dá»‹ch" styleClass="section-subtitle"/>
                    <VBox spacing="10">
                        <VBox spacing="5">
                            <Label text="Ghi chÃº (tÃ¹y chá»n):"/>
                            <TextArea fx:id="paymentNotesArea" prefRowCount="3" wrapText="true" 
                                    promptText="Nháº­p ghi chÃº vá» giao dá»‹ch..."/>
                        </VBox>
                    </VBox>
                </VBox>

                <!-- Hidden fields for legacy compatibility -->
                <TextField fx:id="vatPercentField" text="8" visible="false" managed="false"/>
                <RadioButton fx:id="discountPercentRadio" text="Pháº§n trÄƒm" visible="false" managed="false"/>
                <RadioButton fx:id="discountAmountRadio" text="VNÄ" visible="false" managed="false"/>
                <TextField fx:id="discountValueField" text="0" visible="false" managed="false"/>
                <Label fx:id="discountUnitLabel" text="pháº§n trÄƒm" visible="false" managed="false"/>
                <Label fx:id="discountErrorLabel" text="" visible="false" managed="false"/>
            </VBox>
        </HBox>
    </center>

    <!-- Footer -->
    <bottom>
        <HBox styleClass="footer-container" spacing="10" alignment="CENTER_RIGHT">
            <padding>
                <Insets top="15" right="20" bottom="15" left="20"/>
            </padding>
            
            <Button fx:id="printReceiptButton" text="ðŸ–¨ï¸ In hÃ³a Ä‘Æ¡n" styleClass="secondary-button" 
                    prefWidth="100" maxWidth="120"/>
            <Button fx:id="cancelButton" text="âŒ Há»§y" styleClass="cancel-button" 
                    prefWidth="80" maxWidth="100"/>
            <Button fx:id="payButton" text="ðŸ’° THANH TOÃN" styleClass="primary-button" 
                    defaultButton="true" prefWidth="120" maxWidth="140"/>
        </HBox>
    </bottom>

</BorderPane>