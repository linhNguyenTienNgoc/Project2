<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<VBox alignment="CENTER" spacing="20" style="-fx-background-color: #f8f9fa;" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.cafe.controller.admin.ReportController">

    <padding>
        <Insets bottom="30" left="30" right="30" top="30" />
    </padding>

    <!-- Filter Controls -->
    <HBox alignment="CENTER" spacing="15">
        <DatePicker fx:id="startDatePicker" promptText="Từ ngày" />
        <DatePicker fx:id="endDatePicker" promptText="Đến ngày" />
        <ComboBox fx:id="reportTypeCombo" promptText="Loại báo cáo" style="-fx-pref-width: 150;" />
        <Button fx:id="generateReportButton" style="-fx-background-color: #2E86AB; -fx-text-fill: white;" text="Tạo báo cáo" />
        <Button fx:id="exportExcelButton" style="-fx-background-color: #28a745; -fx-text-fill: white;" text="Xuất Excel" />
        <Button fx:id="exportPDFButton" style="-fx-background-color: #dc3545; -fx-text-fill: white;" text="Xuất PDF" />
    </HBox>

    <!-- Statistics Cards -->
    <HBox alignment="CENTER" spacing="20">
        <VBox alignment="CENTER" style="-fx-background-color: #e8f5e8; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 150;">
            <Label fx:id="todayRevenueLabel" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #2e7d32;" text="0 VNĐ" />
            <Label style="-fx-font-size: 12px; -fx-text-fill: #666;" text="Doanh thu hôm nay" />
            <Label style="-fx-font-size: 14px; -fx-text-fill: #2e7d32; -fx-font-weight: bold;" text="+0%" />
        </VBox>

        <VBox alignment="CENTER" style="-fx-background-color: #fff3e0; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 150;">
            <Label fx:id="todayOrdersLabel" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #f57c00;" text="0" />
            <Label style="-fx-font-size: 12px; -fx-text-fill: #666;" text="Đơn hàng hôm nay" />
            <Label style="-fx-font-size: 14px; -fx-text-fill: #f57c00; -fx-font-weight: bold;" text="+0%" />
        </VBox>

        <VBox alignment="CENTER" style="-fx-background-color: #e3f2fd; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 150;">
            <Label fx:id="newCustomersLabel" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #1976d2;" text="0" />
            <Label style="-fx-font-size: 12px; -fx-text-fill: #666;" text="Khách hàng mới" />
            <Label style="-fx-font-size: 14px; -fx-text-fill: #1976d2; -fx-font-weight: bold;" text="+0%" />
        </VBox>

        <VBox alignment="CENTER" style="-fx-background-color: #fce4ec; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 150;">
            <Label fx:id="monthlyProfitLabel" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #c2185b;" text="0 VNĐ" />
            <Label style="-fx-font-size: 12px; -fx-text-fill: #666;" text="Lợi nhuận tháng" />
            <Label style="-fx-font-size: 14px; -fx-text-fill: #c2185b; -fx-font-weight: bold;" text="+0%" />
        </VBox>
    </HBox>

    <!-- Report Content -->
    <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS">
        <TabPane style="-fx-background-color: white; -fx-background-radius: 10;">

            <!-- Sales Report Tab -->
            <Tab closable="false" text="Báo cáo doanh thu">
                <VBox spacing="15" style="-fx-padding: 20;">

                    <!-- Chart Container -->
                    <VBox fx:id="salesChartContainer" spacing="10">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Biểu đồ doanh thu theo ngày" />
                        <!-- Charts will be added programmatically here -->
                    </VBox>

                    <!-- Table -->
                    <VBox spacing="10">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Chi tiết doanh thu" />
                        <TableView fx:id="salesTable" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="dateColumn" prefWidth="120" text="Ngày" />
                                <TableColumn fx:id="revenueColumn" prefWidth="150" text="Doanh thu" />
                                <TableColumn fx:id="orderCountColumn" prefWidth="120" text="Số đơn hàng" />
                                <TableColumn fx:id="avgOrderColumn" prefWidth="150" text="Trung bình/đơn" />
                                <TableColumn fx:id="growthColumn" prefWidth="100" text="Tăng trường" />
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>

            <!-- Product Report Tab -->
            <Tab closable="false" text="Báo cáo sản phẩm">
                <VBox spacing="15" style="-fx-padding: 20;">

                    <!-- Chart Container -->
                    <VBox fx:id="productChartContainer" spacing="10">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Biểu đồ phân bố sản phẩm" />
                        <!-- Charts will be added programmatically here -->
                    </VBox>

                    <!-- Table -->
                    <VBox spacing="10">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Top sản phẩm bán chạy" />
                        <TableView fx:id="productTable" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="productNameColumn" prefWidth="200" text="Sản phẩm" />
                                <TableColumn fx:id="quantityColumn" prefWidth="120" text="Số lượng bán" />
                                <TableColumn fx:id="productRevenueColumn" prefWidth="150" text="Doanh thu" />
                                <TableColumn fx:id="percentageColumn" prefWidth="150" text="Tổng doanh thu" />
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>

            <!-- Customer Report Tab -->
            <Tab closable="false" text="Báo cáo khách hàng">
                <VBox spacing="15" style="-fx-padding: 20;">

                    <!-- Chart Container -->
                    <VBox fx:id="customerChartContainer" spacing="10">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Biểu đồ top khách hàng" />
                        <!-- Charts will be added programmatically here -->
                    </VBox>

                    <!-- Table -->
                    <VBox spacing="10">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Thống kê khách hàng" />
                        <TableView fx:id="customerTable" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="customerNameColumn" prefWidth="200" text="Khách hàng" />
                                <TableColumn fx:id="customerOrderCountColumn" prefWidth="120" text="Số đơn hàng" />
                                <TableColumn fx:id="customerTotalColumn" prefWidth="150" text="Tổng chi tiêu" />
                                <TableColumn fx:id="lastOrderColumn" prefWidth="120" text="Đơn hàng cuối" />
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>

            <!-- Summary Tab -->
            <Tab closable="false" text="Tổng quan">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="20" style="-fx-padding: 20;">

                        <!-- Overall Statistics -->
                        <VBox spacing="10">
                            <Label style="-fx-font-size: 18px; -fx-font-weight: bold;" text="Thống kê tổng quan" />

                            <HBox spacing="20">
                                <VBox alignment="CENTER" style="-fx-background-color: #f8f9fa; -fx-padding: 15; -fx-background-radius: 8; -fx-border-color: #dee2e6; -fx-border-radius: 8;">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="Doanh thu cao nhất" />
                                    <Label style="-fx-font-size: 20px; -fx-text-fill: #28a745;" text="--" />
                                </VBox>

                                <VBox alignment="CENTER" style="-fx-background-color: #f8f9fa; -fx-padding: 15; -fx-background-radius: 8; -fx-border-color: #dee2e6; -fx-border-radius: 8;">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="Sản phẩm bán chạy nhất" />
                                    <Label style="-fx-font-size: 20px; -fx-text-fill: #007bff;" text="--" />
                                </VBox>

                                <VBox alignment="CENTER" style="-fx-background-color: #f8f9fa; -fx-padding: 15; -fx-background-radius: 8; -fx-border-color: #dee2e6; -fx-border-radius: 8;">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="Khách hàng VIP" />
                                    <Label style="-fx-font-size: 20px; -fx-text-fill: #dc3545;" text="--" />
                                </VBox>
                            </HBox>
                        </VBox>

                        <!-- Trend Analysis -->
                        <VBox spacing="10">
                            <Label style="-fx-font-size: 18px; -fx-font-weight: bold;" text="Phân tích xu hướng" />

                            <HBox spacing="20">
                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="📈 Doanh thu tăng trưởng" />
                                    <Label style="-fx-font-size: 12px;" text="So với kỳ trước: +15.3%" />
                                    <Label style="-fx-font-size: 12px;" text="Xu hướng: Tích cực" />
                                </VBox>

                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="👥 Khách hàng mới" />
                                    <Label style="-fx-font-size: 12px;" text="Tháng này: +8.7%" />
                                    <Label style="-fx-font-size: 12px;" text="Xu hướng: Ổn định" />
                                </VBox>

                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="🛍️ Đơn hàng trung bình" />
                                    <Label style="-fx-font-size: 12px;" text="Giá trị: +12.1%" />
                                    <Label style="-fx-font-size: 12px;" text="Xu hướng: Tăng" />
                                </VBox>
                            </HBox>
                        </VBox>

                        <!-- Performance Metrics -->
                        <VBox spacing="10">
                            <Label style="-fx-font-size: 18px; -fx-font-weight: bold;" text="Chỉ số hiệu suất" />

                            <HBox spacing="20">
                                <VBox spacing="8" style="-fx-background-color: #e8f5e8; -fx-padding: 15; -fx-background-radius: 8; -fx-min-width: 200;">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="💰 Tỷ suất lợi nhuận" />
                                    <Label style="-fx-font-size: 24px; -fx-text-fill: #28a745;" text="68.5%" />
                                    <Label style="-fx-font-size: 12px; -fx-text-fill: #666;" text="Mục tiêu: 65%" />
                                </VBox>

                                <VBox spacing="8" style="-fx-background-color: #fff3e0; -fx-padding: 15; -fx-background-radius: 8; -fx-min-width: 200;">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="🎯 Tỷ lệ khách quay lại" />
                                    <Label style="-fx-font-size: 24px; -fx-text-fill: #f57c00;" text="72.3%" />
                                    <Label style="-fx-font-size: 12px; -fx-text-fill: #666;" text="Mục tiêu: 70%" />
                                </VBox>

                                <VBox spacing="8" style="-fx-background-color: #e3f2fd; -fx-padding: 15; -fx-background-radius: 8; -fx-min-width: 200;">
                                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="⭐ Đánh giá trung bình" />
                                    <Label style="-fx-font-size: 24px; -fx-text-fill: #1976d2;" text="4.7/5" />
                                    <Label style="-fx-font-size: 12px; -fx-text-fill: #666;" text="Mục tiêu: 4.5/5" />
                                </VBox>
                            </HBox>
                        </VBox>

                    </VBox>
                </ScrollPane>
            </Tab>
        </TabPane>
    </ScrollPane>

</VBox>